<% provide(:title, 'New User Enrolment') %>
<div id="newcontainer">
  <h1>Enrol a new User</h1>

  <div class="stdcontainer">
    <div class="row">
      <div class="col-md-6 col-md-offset-3">
        <%= render 'form' %>
      </div>
    </div>
  </div>
</div>
<script>
var users = new Bloodhound({
  datumTokenizer: Bloodhound.tokenizers.obj.whitespace('name'),
  queryTokenizer: Bloodhound.tokenizers.whitespace,
  identify: function(obj) { return obj.name; },
  prefetch: '/user.json'
});

function namesWithDefaults(q, sync) {
  if (q === '') {
    sync(users.index.all());
  }

  else {
    users.search(q, sync);
  }
}

// passing in `null` for the `options` arguments will result in the default
// options being used
$('#user-scrollable-dropdown-menu .typeahead').typeahead({
  minLength: 0,
  highlight: true
},
{
  name: 'user',
  displayKey: 'name',
  limit: 500, // hard coded value, not sure how to get actual length of the json file
  source: namesWithDefaults
});
</script>
